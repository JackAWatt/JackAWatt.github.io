<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap and scanning</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="trash.html">trash</a></p>

<p><a href="lockpicking.html">lockpicking</a></p>

<ol>
<li><a href="lockpicking--blackbox_picking.html">blackbox picking</a></li>
</ol>
<p><a href="new_folder_2.html">new folder 2</a></p>

<p><a href="Commands.html">Commands</a></p>

<ol>
<li><a href="Commands--arp-spoof.html">arp-spoof</a></li>
<li><a href="Commands--wp-scan.html">wp-scan</a></li>
<li><a href="Commands--put-http.html">put-http</a></li>
<li><a href="Commands--crackmapexec.html">crackmapexec</a></li>
<li><a href="Commands--redis.html">redis</a></li>
<li><a href="Commands--sshuttle.html">sshuttle</a></li>
<li><a href="Commands--c~.html">c#</a></li>
<li><a href="Commands--nikto-proxy.html">nikto-proxy</a></li>
<li><a href="Commands--gather-gpp-creds.html">gather-gpp-creds</a></li>
<li><a href="Commands--webdav.html">webdav</a></li>
<li><a href="Commands--trash.html">trash</a></li>
<li><a href="Commands--nessus-openvas.html">nessus-openvas</a></li>
<li><a href="Commands--mimikatz.html">mimikatz</a></li>
<ol>
<li><a href="Commands--mimikatz--mimikatz_-_remote_control,_rpc.html">mimikatz - remote control, rpc</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_list_commands_in_module.html">mimikatz - list commands in module</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_start_and_stop_processes.html">mimikatz - start and stop processes</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_applocker_bypass_and_other_sn.html">mimikatz - applocker bypass and other sn</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_rdp.html">mimikatz - rdp</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_avoid_new_events.html">mimikatz - avoid new events</a></li>
<li><a href="Commands--mimikatz--mimikatz_list_modules.html">mimikatz list modules</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_tokens.html">mimikatz - tokens</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_base64_all_the_things.html">mimikatz - base64 all the things</a></li>
</ol>
<li><a href="Commands--masscan.html">masscan</a></li>
<li><a href="Commands--nmap_and_scanning.html">nmap and scanning</a></li>
<li><a href="Commands--shellshock-squid.html">shellshock-squid</a></li>
<li><a href="Commands--virtual-box_guest_additions.html">virtual-box guest additions</a></li>
<li><a href="Commands--rbash.html">rbash</a></li>
<li><a href="Commands--ping_sweep.html">ping sweep</a></li>
<li><a href="Commands--cut_commands.html">cut commands</a></li>
<li><a href="Commands--mount-shares.html">mount-shares</a></li>
<li><a href="Commands--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--xss-iframe.html">xss-iframe</a></li>
<li><a href="Commands--dns-zone-transfer.html">dns-zone-transfer</a></li>
<li><a href="Commands--nginx-bypass.html">nginx-bypass</a></li>
<li><a href="Commands--spawn_a_better_shell_-_break_out_of_shit.html">spawn_a_better_shell - break out of shit</a></li>
<li><a href="Commands--port-forward.html">port-forward</a></li>
<li><a href="Commands--physical_hacking.html">physical hacking</a></li>
<ol>
<li><a href="Commands--physical_hacking--rasperry_pi.html">rasperry pi</a></li>
<li><a href="Commands--physical_hacking--bash_bunny.html">bash bunny</a></li>
</ol>
<li><a href="Commands--searchsploit.html">searchsploit</a></li>
<li><a href="Commands--custom-payloads.html">custom-payloads</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land.html">bypass applocker - live off land</a></li>
<ol>
<li><a href="Commands--bypass_applocker_-_live_off_land--msbuild.html">msbuild</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--installutil.html">installutil</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--demiguise.html">demiguise</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--mshta.html">mshta</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--regsvcs.html">regsvcs</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--pubprn.vbs.html">pubprn.vbs</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--regasm_2.html">regasm 2</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--vbs_macro.html">vbs macro</a></li>
</ol>
<li><a href="Commands--pass_the_hash.html">pass the hash</a></li>
<li><a href="Commands--snmp.html">snmp</a></li>
<li><a href="Commands--client-side-iframe-attack.html">client-side-iframe-attack</a></li>
<li><a href="Commands--mortar-shells.html">mortar-shells</a></li>
<li><a href="Commands--bypass-uac.html">bypass-uac</a></li>
<li><a href="Commands--privilege-escalation-linux.html">privilege-escalation-linux</a></li>
<li><a href="Commands--rdesktop_and_screen_for_linux.html">rdesktop and screen for linux</a></li>
<li><a href="Commands--password-cracking.html">password-cracking</a></li>
<li><a href="Commands--cobalt_strike_2.html">cobalt strike 2</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--cobalt_strike_certificates.html">cobalt strike certificates</a></li>
<li><a href="Commands--cobalt_strike_2--malleable.html">malleable</a></li>
<li><a href="Commands--cobalt_strike_2--cpl_resource_runner_payload.html">cpl resource runner payload</a></li>
<li><a href="Commands--cobalt_strike_2--situational_awareness_-_harmj0y.html">situational awareness - harmj0y</a></li>
<li><a href="Commands--cobalt_strike_2--go_daddy_domain.html">go daddy domain</a></li>
<li><a href="Commands--cobalt_strike_2--safety.html">safety</a></li>
<li><a href="Commands--cobalt_strike_2--random_commands.html">random commands</a></li>
<li><a href="Commands--cobalt_strike_2--playbook.html">playbook</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--playbook--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--overpass_the_hash_with_rubeus-beacon_-_h.html">overpass the hash with rubeus-beacon - h</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--after_initial_access.html">after initial access</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--persistence.html">persistence</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--mail_and_smtp_enumeration-manipulation.html">mail and smtp enumeration-manipulation</a></li>
</ol>
<li><a href="Commands--cobalt_strike_2--generating_certificates.html">generating certificates</a></li>
<li><a href="Commands--cobalt_strike_2--github_repos.html">github repos</a></li>
<li><a href="Commands--cobalt_strike_2--golden_ticket.html">golden ticket</a></li>
<li><a href="Commands--cobalt_strike_2--apache_rewrite_.htaccess.html">apache rewrite .htaccess</a></li>
<li><a href="Commands--cobalt_strike_2--malware_av_evasion.html">malware av evasion</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--malware_av_evasion--main.go.html">main.go</a></li>
</ol>
<li><a href="Commands--cobalt_strike_2--c2_infrastructure.html">c2 infrastructure</a></li>
<li><a href="Commands--cobalt_strike_2--sid_hopping.html">sid hopping</a></li>
</ol>
<li><a href="Commands--random_shellcode_-_scratch-pad.html">random shellcode - scratch-pad</a></li>
<li><a href="Commands--powerview.html">powerview</a></li>
<ol>
<li><a href="Commands--powerview--new_page.html">new page</a></li>
</ol>
<li><a href="Commands--windows.html">windows</a></li>
<ol>
<li><a href="Commands--windows--windows_-_powerview_3.0,_harmj0y.html">windows - powerview 3.0, harmj0y</a></li>
<li><a href="Commands--windows--windows_passwords.html">windows passwords</a></li>
<li><a href="Commands--windows--windows_-_search_4_loot.html">windows - search 4 loot</a></li>
<li><a href="Commands--windows--windows_-_laps_abuse.html">windows - laps abuse</a></li>
<li><a href="Commands--windows--windows_-_powershell_web_access.html">windows - powershell web access</a></li>
<li><a href="Commands--windows--windows_-_port_forward.html">windows - port forward</a></li>
<li><a href="Commands--windows--windows_privesc.html">windows privesc</a></li>
<li><a href="Commands--windows--windows_enumeration.html">windows enumeration</a></li>
<li><a href="Commands--windows--windows_-_uninstall_patches.html">windows - uninstall patches</a></li>
<li><a href="Commands--windows--windows_-_powerview,_enumerate_groups-ac.html">windows - powerview, enumerate groups-ac</a></li>
<li><a href="Commands--windows--windows_-_powerview_acl_enum-abuse.html">windows - powerview acl enum-abuse</a></li>
<li><a href="Commands--windows--windows_service_abuse.html">windows service abuse</a></li>
<li><a href="Commands--windows--windows_firewall.html">windows firewall</a></li>
<li><a href="Commands--windows--windows_-_powershell_-_quickies.html">windows - powershell - quickies</a></li>
</ol>
<li><a href="Commands--outlook_and_owa.html">outlook and owa</a></li>
<li><a href="Commands--tmux_2.html">tmux 2</a></li>
<ol>
<li><a href="Commands--tmux_2--tmux_config.html">tmux config</a></li>
<li><a href="Commands--tmux_2--tmux_cheat_sheet.html">tmux cheat sheet</a></li>
</ol>
<li><a href="Commands--reverse_shell_one_liners.html">reverse shell one liners</a></li>
<ol>
<li><a href="Commands--reverse_shell_one_liners--java_reverse_shell.html">java reverse shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--python_reverse_shell.html">python reverse shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--php-reverse-shell.html">php-reverse-shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--perl-reverse-shell-cgi-format.html">perl-reverse-shell-cgi-format</a></li>
<li><a href="Commands--reverse_shell_one_liners--c-language-reverse-shell.html">c-language-reverse-shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--ruby.html">ruby</a></li>
</ol>
<li><a href="Commands--tar.html">tar</a></li>
<li><a href="Commands--ssh.html">ssh</a></li>
<li><a href="Commands--named_pipes.html">named pipes</a></li>
<li><a href="Commands--enumeration.html">enumeration</a></li>
<li><a href="Commands--python.html">python</a></li>
<li><a href="Commands--nac_testing.html">nac testing</a></li>
<li><a href="Commands--red_team.html">red team</a></li>
<ol>
<li><a href="Commands--red_team--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--red_team--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--red_team--privilege_escalation_across_trusts.html">privilege escalation across trusts</a></li>
<li><a href="Commands--red_team--active_directory_one_liners.html">active directory one liners</a></li>
<li><a href="Commands--red_team--enumeration.html">enumeration</a></li>
<li><a href="Commands--red_team--persistence_techniques.html">persistence techniques</a></li>
<li><a href="Commands--red_team--abusing_sql_server_trusts.html">abusing sql server trusts</a></li>
<ol>
<li><a href="Commands--red_team--abusing_sql_server_trusts--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--red_team--abusing_sql_server_trusts--post_exploitation_enumeration.html">post exploitation enumeration</a></li>
</ol>
<li><a href="Commands--red_team--domain_privilege_escalation.html">domain privilege escalation</a></li>
<li><a href="Commands--red_team--file_servers_and_files.html">file servers and files</a></li>
<li><a href="Commands--red_team--bloodhound.html">bloodhound</a></li>
<li><a href="Commands--red_team--forest_enumeration.html">forest enumeration</a></li>
</ol>
<li><a href="Commands--smb-netbios-rpc.html">smb-netbios-rpc</a></li>
<li><a href="Commands--laps.html">laps</a></li>
<li><a href="Commands--password-grep.html">password-grep</a></li>
<li><a href="Commands--xml-xxe-xpath.html">xml-xxe-xpath</a></li>
<li><a href="Commands--ports.html">ports</a></li>
<li><a href="Commands--de-duplicate.html">de-duplicate</a></li>
<li><a href="Commands--mac_address_change.html">mac address change</a></li>
<li><a href="Commands--test-for-xxe.html">test-for-xxe</a></li>
<li><a href="Commands--droopescan.html">droopescan</a></li>
<li><a href="Commands--dnscat.html">dnscat</a></li>
<li><a href="Commands--fresh-install.html">fresh-install</a></li>
<li><a href="Commands--httpscreenshot.html">httpscreenshot</a></li>
<li><a href="Commands--buffer-overflow.html">buffer-overflow</a></li>
<li><a href="Commands--osint.html">osint</a></li>
<li><a href="Commands--spooler_exploit.html">spooler exploit</a></li>
<li><a href="Commands--wifi-hacking.html">wifi-hacking</a></li>
<ol>
<li><a href="Commands--wifi-hacking--aircrack-ng_and_jtr_attack.html">aircrack-ng and jtr attack</a></li>
<li><a href="Commands--wifi-hacking--crack_wep.html">crack wep</a></li>
<li><a href="Commands--wifi-hacking--aircrack-ng.html">aircrack-ng</a></li>
<li><a href="Commands--wifi-hacking--fluxion.html">fluxion</a></li>
<li><a href="Commands--wifi-hacking--reaver.html">reaver</a></li>
<li><a href="Commands--wifi-hacking--wep_shared_key_authentication_attack.html">wep shared key authentication attack</a></li>
<li><a href="Commands--wifi-hacking--cowpatty_attack.html">cowpatty attack</a></li>
<li><a href="Commands--wifi-hacking--new_page.html">new page</a></li>
<li><a href="Commands--wifi-hacking--hostapd.html">hostapd</a></li>
<li><a href="Commands--wifi-hacking--rogue_access_point.html">rogue access point</a></li>
<li><a href="Commands--wifi-hacking--cracking_wpa_attack.html">cracking wpa attack</a></li>
<li><a href="Commands--wifi-hacking--wifite.html">wifite</a></li>
<li><a href="Commands--wifi-hacking--eaphammer.html">eaphammer</a></li>
<li><a href="Commands--wifi-hacking--handshake-via-pcap.html">handshake-via-pcap</a></li>
<li><a href="Commands--wifi-hacking--cracking_wep_via_a_client_attack.html">cracking wep via a client attack</a></li>
<li><a href="Commands--wifi-hacking--basics.html">basics</a></li>
<li><a href="Commands--wifi-hacking--pyrit_attack.html">pyrit attack</a></li>
<li><a href="Commands--wifi-hacking--clientless_wep_attack.html">clientless wep attack</a></li>
</ol>
<li><a href="Commands--images-with-files-in-them.html">images-with-files-in-them</a></li>
<li><a href="Commands--xxd.html">xxd</a></li>
<li><a href="Commands--proxychains.html">proxychains</a></li>
<li><a href="Commands--tools-sources.html">tools-sources</a></li>
<li><a href="Commands--lolbins.html">lolbins</a></li>
<li><a href="Commands--goddi_-_domain_enumeration.html">goddi - domain enumeration</a></li>
<li><a href="Commands--sed_and_changing_files_for_malware_evasi.html">sed and changing files for malware evasi</a></li>
<li><a href="Commands--mail_sniper.html">mail sniper</a></li>
<li><a href="Commands--postgresql.html">postgresql</a></li>
<li><a href="Commands--files-inside-of-pictures.html">files-inside-of-pictures</a></li>
<li><a href="Commands--unicorn_scan.html">unicorn scan</a></li>
<li><a href="Commands--metasploit-meterpreter.html">metasploit-meterpreter</a></li>
<ol>
<li><a href="Commands--metasploit-meterpreter--metasploit_-_reverse_shells.html">metasploit - reverse_shells</a></li>
<li><a href="Commands--metasploit-meterpreter--metasploit-nessus.html">metasploit-nessus</a></li>
<li><a href="Commands--metasploit-meterpreter--meterpreter.html">meterpreter</a></li>
<li><a href="Commands--metasploit-meterpreter--network.html">network</a></li>
</ol>
<li><a href="Commands--compiling-code.html">compiling-code</a></li>
<li><a href="Commands--remote_and_local_file_inclusion.html">remote and local file inclusion</a></li>
<li><a href="Commands--proxychains-admin-network.html">proxychains-admin-network</a></li>
<li><a href="Commands--linux.html">linux</a></li>
<li><a href="Commands--privilege-escalation-windows_-_and_empir.html">privilege-escalation-windows - and empir</a></li>
<li><a href="Commands--powershell.html">powershell</a></li>
<ol>
<li><a href="Commands--powershell--constrained_language_breakout.html">constrained language breakout</a></li>
<li><a href="Commands--powershell--powerup_-_privilege_escalation.html">powerup - privilege escalation</a></li>
<li><a href="Commands--powershell--user_enumeration.html">user enumeration</a></li>
<li><a href="Commands--powershell--powershell_-_get-system.html">powershell - get-system</a></li>
<li><a href="Commands--powershell--powershell_sans_cheat.html">powershell sans cheat</a></li>
<li><a href="Commands--powershell--find_files_by_name.html">find files by name</a></li>
<li><a href="Commands--powershell--random_powershell.html">random powershell</a></li>
<li><a href="Commands--powershell--domain_enumeration.html">domain enumeration</a></li>
<li><a href="Commands--powershell--enable_psremoting.html">enable psremoting</a></li>
</ol>
<li><a href="Commands--sql.html">sql</a></li>
<li><a href="Commands--waf.html">waf</a></li>
<li><a href="Commands--network-change-ip.html">network-change-ip</a></li>
<li><a href="Commands--merlin.html">merlin</a></li>
<li><a href="Commands--web_discovery.html">web discovery</a></li>
<li><a href="Commands--exploit-pack.html">exploit-pack</a></li>
<li><a href="Commands--get-browserdata.html">get-browserdata</a></li>
<li><a href="Commands--user_agent.html">user agent</a></li>
<li><a href="Commands--group-policy-decrypt-passwords.html">group-policy-decrypt-passwords</a></li>
<li><a href="Commands--root_user_add.html">root_user_add</a></li>
<li><a href="Commands--hex_encode_command_line.html">hex encode command line</a></li>
<li><a href="Commands--block-ip-iptables.html">block-ip-iptables</a></li>
<li><a href="Commands--host_discovery-dns.html">host_discovery-dns</a></li>
<li><a href="Commands--certificate_tls_and_ssl.html">certificate tls and ssl</a></li>
<li><a href="Commands--wget.html">wget</a></li>
<li><a href="Commands--php-shells.html">php-shells</a></li>
<li><a href="Commands--payloads.html">payloads</a></li>
<li><a href="Commands--ad-notes.html">ad-notes</a></li>
<ol>
<li><a href="Commands--ad-notes--laps_abuse.html">laps abuse</a></li>
<li><a href="Commands--ad-notes--more-ad-notes.html">more-ad-notes</a></li>
<li><a href="Commands--ad-notes--ad-notes-chirag.html">ad-notes-chirag</a></li>
<li><a href="Commands--ad-notes--pam_abuse.html">pam abuse</a></li>
</ol>
<li><a href="Commands--have_a_shell.html">have_a_shell</a></li>
<li><a href="Commands--curl-wget.html">curl-wget</a></li>
<li><a href="Commands--shell-for-buffer-overflow.html">shell-for-buffer-overflow</a></li>
<li><a href="Commands--__NOTEBOOK__.html">__NOTEBOOK__</a></li>
<ol>
<li><a href="Commands--__NOTEBOOK__--icons.html">icons</a></li>
<li><a href="Commands--__NOTEBOOK__--lost_found.html">lost_found</a></li>
<li><a href="Commands--__NOTEBOOK__--orphans.html">orphans</a></li>
</ol>
<li><a href="Commands--netcat-ftp.html">netcat-ftp</a></li>
<li><a href="Commands--responder.html">responder</a></li>
<li><a href="Commands--assembly.html">assembly</a></li>
</ol>
<p><a href="mobile.html">mobile</a></p>

<ol>
<li><a href="mobile--smali_and_baksmali.html">smali and baksmali</a></li>
<li><a href="mobile--dex2jar.html">dex2jar</a></li>
<li><a href="mobile--apktool.html">apktool</a></li>
<li><a href="mobile--baby_steps.html">baby steps</a></li>
<li><a href="mobile--jd-gui.html">jd-gui</a></li>
<li><a href="mobile--qark.html">qark</a></li>
</ol>
<p><a href="mainframe.html">mainframe</a></p>

<ol>
<li><a href="mainframe--nmap_stuff_-_recon.html">nmap stuff - recon</a></li>
<li><a href="mainframe--tso_commands.html">tso commands</a></li>
</ol>
<p><a href="links_and_random.html">links and random</a></p>

<ol>
<li><a href="links_and_random--mimikatz.html">mimikatz</a></li>
<li><a href="links_and_random--wifi_driver_stuff.html">wifi driver stuff</a></li>
<li><a href="links_and_random--bypassing_applocker_living_off_land.html">bypassing applocker living off land</a></li>
<li><a href="links_and_random--ptx.html">ptx</a></li>
</ol></div>
<div class="page"><h1><b><u>nmap and scanning</u></b></h1><span style="color:#ff0000;">nmap sneaky syn scan with different user agent, searching for web services</span><br /><br />nmap -sS -p 80,443,8080 --open --script http-title --script-args 'http.useragent="Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko"' 10.10.40.0/24<span style="color:#ff0000;"><br /><br />nmap scan Ipv6 <br /><br /></span><span style="color:#000000;">nmap -6 dead:beef::11be:2d04:b08e:84ff</span><br /><br /><span style="color:#ff0000;">nmap to xml then xml to html</span><br /><br />nmap -A -p- 192.168.26.141 -oX /root/Desktop/test.xml nmap -sS -p<br /><br />xsltproc test.xml -o test.html<br /><br />nmap -Pn -p- -sI 10.185.10.20 10.185.11.1 &lt;--idle scan<br /><br />apt-get install xsltproc<br /><br />nmap -sS -p 80,443,8080 --open --script http-title --script-args<br />'http.useragent="Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like<br />Gecko"' 10.10.40.0/24<br /><br />======================<br /><br /><span style="color:#ff0000;">Zone transfer</span><br /><br />dig @10.50.96.5 foocampus.com -t AXFR<br /><br />Check for dns port open from dns port (sometimes port 53 only responds to port 53)<br /><br />nmap -sS --source-port 53 -p 53 10.50.97.5 <br /><br />---------------<br /><br />nmap -sT -p 53 10.10.10.*<br /><br />once this is found do<br /><br />dig @&lt;ipaddress with DNS open&gt; -x &lt;ipaddress with DNS open&gt;<br /><br />now you should see something like <br /><br />answer section<br />10.5.16.172.in-addr.arpa     1200     IN     PTR     dc01.sportsfoo.com<br />                                                     -------------------<br /><br />the sportsfoo.com is the domain name<br /><br />now you can do<br /><br />dig@&lt;ipaddress with DNS open&gt; -t AXFR sportsfoo.com  &lt;--this will do a zone transfer with info from above.<br /><br />------------------------<br /><span style="color:#ff0000;">bash scripts</span><br /><br />if zone transfer fails, you can do the following<br /><br />nmap -sP 172.16.5.* -oG - | awk '/Up/{print $2}' &gt; alive.txt &amp;&amp; cat alive.txt<br /><br />for name in $(cat /usr/share/fierce/hosts.txt); do host $name.sportfoo.com &lt;ipaddress with DNS open&gt; -W 2; done | grep 'has address'<br /><br /><br />for name in $(cat /usr/share/fierce/hosts.txt); do host $name.sportsfoo.com 172.16.5.10 -W 2; done | grep 'has address'<br /><br /><br />----------------------<br /><br /><span style="color:#ff0000;">Unicorn Scan</span><br /><br />unicornscan -msf &lt;IPaddress&gt;:a &gt; nametcp.txt<br /><br />unicornscan -mU &lt;IPaddress&gt;:a &gt; nameudp.txt<br /><br />----------------------<br /><br /><span style="color:#ff0000;">Blue Squirrel Scan</span><br /><br />unicornscan -msf -R1 -L10 -p1-65535 -r 300 $1<br /><br /><br />--------------------<br /><br /><span style="color:#ff0000;">Precise nmap scan - version scan, OS detection, vuln checks, default scans, and all outputs<br /><br /></span>nmap -sS -sU -sV --reason -vv -O --script vuln, default -p- &lt;ip address&gt; -oA &lt;name of file&gt;<br /><br /><br />-----------------------<br /><br /><span style="color:#ff0000;">1: Host Discovery</span><br /><br />The Nmap command to perform a ping sweep, and then save the results<br /><br />into an xml, is the following:<br /><br />&gt;&gt;nmap –PE –sn -n 10.50.96.0/23 –oX /root/Desktop/scan.xml<br /><br />where with the -sn we tell nmap to not do a port scan after a host<br /><br />discovery, the -PE enables ICMP Echo request host discovery (Ping scan)<br /><br />and with the -oX we tell nmap to save the results into an XML file (in our<br /><br />case the filename is scan.xml and is located in /root/Desktop).<br /><br />Option -n is optional and skips DNS reverse lookup on all the IP <br />addresses.<br /><br />Hosts found with this scan are 8:<br /><br />Host IP address<br /><br />10.50.96.1<br />10.50.96.105<br />10.50.96.110<br />10.50.96.115<br />10.50.97.1<br />10.50.97.5<br />10.50.97.10<br />10.50.97.15<br />10.50.97.20<br />10.50.97.25<br /><br />Note that if you use only –sn without –PE nmap uses ICMP requests, but<br />will also send a TCP SYN packet on ports 80 and 443 of each host<br /><br />======================<br /><br /><span style="color:#ff0000;">2: Open/Closed/Filtered ports</span><br />Hping3 is one of the most powerful packet crafting tools. It’s very easy to<br /><br />start a TCP communication defining flags to use in order to scan specific<br /><br />ports and hosts. We want to scan ports 23/53/135 on the address<br /><br />10.50.97.5. For a SYN scan, we will have to enable the SYN flag, and<br /><br />according to the response we can determine if a port is<br /><br />open/close/filtered.<br /><br />The command to use is:<br /><br />&gt;&gt;hping3 -S –p 23 10.50.97.5<br />where:<br />–S tells the tool to set the SYN flag,<br />–p option is used to specify the port to scan.<br /><br />We already know that the host is alive, but if we try the previous<br /><br />command we will receive no packets. This could happen when there is a<br /><br />Firewall between us and the target, that blocks our packets.<br /><br />In the same way as before, let’s use the previous command in order to<br /><br />scan port 53:<br /><br />&gt;&gt;hping3 -S –p 53 10.50.97.5<br />In this case the tool tells us that it received the R flag (Reset) and the A<br />(Acknowledgement) flag. This means that the port 53 is closed.<br /><br />The last port to check is 135. The command will look like this:<br /><br />&gt;&gt;hping3 -S –p 135 10.50.97.5<br />In this case the flags are S and A, meaning that the port is open.<br />At the end this is what we have<br /><br />end result?<br /><br /><br />Status Port<br />Open 135<br />Closed 53<br />Filtered 23<br /><br /><br />===========================<br /><br /><span style="color:#ff0000;">3: Hping3: Port scan (TCP)</span><br />In order to perform a TCP scan with Hping3 from port 1 to port 1000 we<br />can use the following option:<br />&gt;&gt;hping3 10.50.97.5 -S --scan known<br />This command will scan the most known ports (known includes all the<br />ports listed in /etc/services) and it will print out information about open<br />ports, which in our case are 135 and 445.<br /><br /><br />=============================<br /><br /><span style="color:#ff0000;">4: nmap: Port scan (UDP)</span><br />Since the previous scan does not reveal any information about<br />open/closed/filtered ports used by UDP services, we can use Nmap to<br />perform an UDP scan and get more information about our target. In order<br />to do that, we can use the following command:<br />&gt;&gt;nmap -sU 10.50.97.5<br />where:<br />-sU tells nmap to perform an UDP scan.<br />Note that the open|filtered result means that no response has been<br />received, and that the port can be open or filtered by a firewall.<br /><br />root@kali:~# nmap -sU 10.50.97.5<br /><br />Starting Nmap 7.01 ( https://nmap.org ) at 2016-06-17 21:12 EDT<br />Nmap scan report for 10.50.97.5<br />Host is up (0.087s latency).<br />Not shown: 991 closed ports<br />PORT     STATE         SERVICE<br />123/udp  open          ntp<br />137/udp  open          netbios-ns<br />138/udp  open|filtered netbios-dgm<br />161/udp  filtered      snmp<br />162/udp  filtered      snmptrap<br />445/udp  open|filtered microsoft-ds<br />500/udp  open|filtered isakmp<br />1900/udp open|filtered upnp<br />4500/udp open|filtered nat-t-ike<br /><br />====================================<br /><br /><span style="color:#ff0000;">5: Nmap: Port scan (TCP)</span><br />In Task 1 we have found a list of alive hosts. We can use this information<br /><br />to create a ‘.txt’ file that contains the list of IP address to take care <br />of.<br /><br />Once we have created the file, we can give it to Nmap and perform a TCP<br /><br />SYN scan in order to find open/closed/filtered ports. The command will<br /><br />look like this:<br /><br />&gt;&gt;nmap -sS -iL /root/Desktop/list.txt<br /><br />where:<br /><br />-sS is the option that tells Nmap to perform the TCP SYN scan<br /><br />-iL tells Nmap to load the addresses to scan from the file ‘list.txt’<br /><br />This command will take times. To check the progress of the scan press<br /><br />the up arrow on your keyboard. <br /><br />======================================<br /><br /><span style="color:#ff0000;">6: Source port</span><br />Sometimes DNS accepts communication only if it comes from port 53.<br /><br />This means that all communications with port different from 53 are<br /><br />blocked by the service or by the firewall. In order to understand if our <br /><br />[Scanning] LAB ID: 3<br /><br />eLearnSecurity s.r.l. © 2012 | H E R A 12<br /><br />target network this policy is in place, we can set-up nmap or Hping3 to<br /><br />use port 53 as source port for the scan.<br /><br />In other words, we have to perform a port scan in the entire network,<br /><br />from port 53 to port 53.<br /><br />To do that we can use the following commands:<br /><br />&gt;&gt;nmap -sS --source-port 53 -p 53 10.50.97.0/24<br /><br />or<br /><br />&gt;&gt;hping3 -S -s 53 –k -p 53 10.50.97.25<br /><br />Note that when you specify a source port, hping takes it as a base port<br /><br />and increases it at every packet sent. You can use the –k (keep) option to<br /><br />prevent this behavior. From the results of the previous two commands,<br /><br />we can see that there is only one host (10.50.97.25) with the port 53<br /><br />open. This is information that we didn’t find using any of the previous<br /><br />scans, so make sure to play with source ports during your scans.<br /><br /><br /><br />=========================================<br /><br /><span style="color:#ff0000;">7: Service detection</span><br /><br />In order to accomplish this task, we can set up Nmap in different ways,<br /><br />depending on the intensity of the scan we want to perform. To perform a<br /><br />service and version detection with nmap, the option to use is the –sV.<br /><br />Note that by default the intensity of the scan is set to 7, but you can <br />use a<br /><br />different intensity with the --version-intensity option.<br /><br />In this case we will show the basic command, but you can use different<br /><br />options and check the different results yourself. If you need more<br /><br />information about it, please check out the Nmap man page here:<br /><br />http://nmap.org/book/man-version-detection.html.<br /><br />The command will then looks like this:<br /><br />&gt;&gt;nmap –sV 10.50.97.0/24<br /><br />Note that Nmap first checks for alive hosts, then performs a port scan and<br /><br />after that, it performs a service and version detection. Moreover you can<br /><br />use the –A option to get more information about services and<br /><br />applications version. This is quite aggressive and will also enable Nmap<br /><br />scripts.<br /><br />===================<br /><br /><br /><span style="color:#ff0000;">8: Find a good zombie (Hping3)</span><br /><br />[Scanning] LAB ID: 3<br /><br />eLearnSecurity s.r.l. © 2012 | H E R A 14<br /><br />In order to find a good zombie, we have to find a host with no active<br /><br />communications, in other words, we have to check if the host is sending<br /><br />packets to and from the network. This means that we have to find a host<br /><br />which its ID field does not change frequently.<br /><br />To do this we can use Hping3 sending packets to open ports at each host<br /><br />in the network, using the following command:<br /><br />&gt;&gt;hping3 -S -r -p 135 10.50.97.10<br /><br />where:<br /><br />-S tells hping to send SYN flag<br /><br />-r displays ID increments relatively<br /><br />In this way if the ID increments by 1 for each packet (id=+1), means that<br /><br />the target is not sending packets through the network and is a good<br /><br />zombie candidate.<br /><br />Another way to check if the target is a good candidate, is by using nmap.<br /><br />We can simply run the following command:<br /><br />&gt;&gt;nmap –O –v –n 10.50.97.10<br /><br />If the value of “IP ID Sequence Generation” is on ‘Incremental’, we can<br /><br />consider the target as a good candidate for our idle scan.<br /><br />=======================<br /><br /><span style="color:#ff0000;">9: Idle Scan</span><br />Now that we have the address of a good zombie we can check if the<br />target hosts have port 23 open :<br /><br />1) Open a console, Start again the previous Hping scan on the<br /><br />zombie (Task 9). This will show us ID’s on the fly.<br /><br />2) Open another console and run the following command:<br /><br />[Scanning] LAB ID: 3<br /><br />eLearnSecurity s.r.l. © 2012 | H E R A 15<br /><br />&gt;&gt;hping3 -a 10.50.97.10 -S -p 23 10.50.96.110<br /><br />If the zombie ID increment is ‘id=+2’ (Console 1) instead of ‘id=+1’, we <br />can<br /><br />deduce that port 23 on the target 10.50.96.105 is open. Otherwise, if the<br /><br />ID still increments by 1, we can deduce that the port is closed.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></div>
</body></html>